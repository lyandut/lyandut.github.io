(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{593:function(t,s,a){t.exports=a.p+"assets/img/smartptr_member.af0bf885.png"},594:function(t,s){t.exports="data:image/png;base64,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"},627:function(t,s,a){"use strict";a.r(s);var n=a(12),r=Object(n.a)({},(function(){var t=this,s=t.$createElement,n=t._self._c||s;return n("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[n("div",{staticClass:"custom-block tip"},[n("p",{staticClass:"title"},[t._v("智能指针")]),n("p",[t._v("平时写代码一直避免使用指针，但在某些场景下指针的使用还是有必要的。最近在项目中简单使用了一下智能指针（"),n("code",[t._v("shared_ptr")]),t._v("），结果踩了不少坑，差点就爬不出来了。痛定思痛抱着《Cpp Primer》啃了两天，看书的时候才发现自己的理解和实践很浅薄，真的是有种后背发凉的感觉。。。特地记录下这些坑点，且警后人（指后来的自己=。=）。")])]),t._v(" "),n("h2",{attrs:{id:"写在前面"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#写在前面"}},[t._v("#")]),t._v(" 写在前面……")]),t._v(" "),n("p",[t._v("本次实验基于的数据结构定义如下：")]),t._v(" "),n("p",[t._v("基类"),n("code",[t._v("Polygon")]),t._v("的成员"),n("code",[t._v("_points")]),t._v("是一个"),n("code",[t._v("shared_ptr")]),t._v("，指向动态分配的"),n("code",[t._v("vector<Point>")]),t._v("，这样实现了在"),n("code",[t._v("Polygon")]),t._v("对象的多个拷贝之间共享相同的"),n("code",[t._v("vector<Point>")]),t._v("。基于"),n("code",[t._v("Polygon")]),t._v("实现了"),n("code",[t._v("Rect")]),t._v("和"),n("code",[t._v("Circle")]),t._v("两个子类。")]),t._v(" "),n("div",{staticClass:"language-cpp line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-cpp"}},[n("code",[n("span",{pre:!0,attrs:{class:"token macro property"}},[n("span",{pre:!0,attrs:{class:"token directive-hash"}},[t._v("#")]),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[t._v("include")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("<vector>")])]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token macro property"}},[n("span",{pre:!0,attrs:{class:"token directive-hash"}},[t._v("#")]),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[t._v("include")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("<string>")])]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token macro property"}},[n("span",{pre:!0,attrs:{class:"token directive-hash"}},[t._v("#")]),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[t._v("include")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("<memory>")])]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token macro property"}},[n("span",{pre:!0,attrs:{class:"token directive-hash"}},[t._v("#")]),n("span",{pre:!0,attrs:{class:"token directive keyword"}},[t._v("include")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("<cassert>")])]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("using")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("namespace")]),t._v(" std"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("static")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("constexpr")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("double")]),t._v(" PI "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("3.14")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("using")]),t._v(" coord_t "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("double")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("struct")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Point")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" coord_t x"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" y"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Polygon")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("Polygon")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" vector"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("Point"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v("points"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("_points")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token generic-function"}},[n("span",{pre:!0,attrs:{class:"token function"}},[t._v("make_shared")]),n("span",{pre:!0,attrs:{class:"token generic class-name"}},[n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" vector"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("Point"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">>")])])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("points"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("virtual")]),t._v(" string "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("shape")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("virtual")]),t._v(" coord_t "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("area")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" shared_ptr"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" vector"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("Point"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">>")]),t._v(" _points"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Rect")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("final")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" Polygon "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("Rect")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" vector"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("Point"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v("points"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" coord_t width"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" coord_t height"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("Polygon")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("points"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("_width")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("width"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("_height")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("height"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("assert")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("points"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("size")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    string "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("shape")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Rect"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    coord_t "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("area")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" _width "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" _height"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" coord_t _width"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" coord_t _height"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Circle")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("final")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" Polygon "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("Circle")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" vector"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("Point"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v("points"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" coord_t radius"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("Polygon")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("points"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("_center")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("points"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("front")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("_radius")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("radius"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("assert")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("points"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("size")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    string "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("shape")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Circle"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    coord_t "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("area")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" PI "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" _radius "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" _radius"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" Point _center"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" coord_t _radius"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("using")]),t._v(" polygon_ptr "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" shared_ptr"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("Polygon"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("using")]),t._v(" rect_ptr "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" shared_ptr"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("Rect"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("using")]),t._v(" circle_ptr "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" shared_ptr"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("Circle"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 定义一个边长为5的矩形和一个半径为5的圆.")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("static")]),t._v(" vector"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("Point"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" r_points"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("static")]),t._v(" coord_t r_width "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" r_height "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("static")]),t._v(" vector"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("Point"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" c_points"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("static")]),t._v(" coord_t c_radius "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br"),n("span",{staticClass:"line-number"},[t._v("4")]),n("br"),n("span",{staticClass:"line-number"},[t._v("5")]),n("br"),n("span",{staticClass:"line-number"},[t._v("6")]),n("br"),n("span",{staticClass:"line-number"},[t._v("7")]),n("br"),n("span",{staticClass:"line-number"},[t._v("8")]),n("br"),n("span",{staticClass:"line-number"},[t._v("9")]),n("br"),n("span",{staticClass:"line-number"},[t._v("10")]),n("br"),n("span",{staticClass:"line-number"},[t._v("11")]),n("br"),n("span",{staticClass:"line-number"},[t._v("12")]),n("br"),n("span",{staticClass:"line-number"},[t._v("13")]),n("br"),n("span",{staticClass:"line-number"},[t._v("14")]),n("br"),n("span",{staticClass:"line-number"},[t._v("15")]),n("br"),n("span",{staticClass:"line-number"},[t._v("16")]),n("br"),n("span",{staticClass:"line-number"},[t._v("17")]),n("br"),n("span",{staticClass:"line-number"},[t._v("18")]),n("br"),n("span",{staticClass:"line-number"},[t._v("19")]),n("br"),n("span",{staticClass:"line-number"},[t._v("20")]),n("br"),n("span",{staticClass:"line-number"},[t._v("21")]),n("br"),n("span",{staticClass:"line-number"},[t._v("22")]),n("br"),n("span",{staticClass:"line-number"},[t._v("23")]),n("br"),n("span",{staticClass:"line-number"},[t._v("24")]),n("br"),n("span",{staticClass:"line-number"},[t._v("25")]),n("br"),n("span",{staticClass:"line-number"},[t._v("26")]),n("br"),n("span",{staticClass:"line-number"},[t._v("27")]),n("br"),n("span",{staticClass:"line-number"},[t._v("28")]),n("br"),n("span",{staticClass:"line-number"},[t._v("29")]),n("br"),n("span",{staticClass:"line-number"},[t._v("30")]),n("br"),n("span",{staticClass:"line-number"},[t._v("31")]),n("br"),n("span",{staticClass:"line-number"},[t._v("32")]),n("br"),n("span",{staticClass:"line-number"},[t._v("33")]),n("br"),n("span",{staticClass:"line-number"},[t._v("34")]),n("br"),n("span",{staticClass:"line-number"},[t._v("35")]),n("br"),n("span",{staticClass:"line-number"},[t._v("36")]),n("br"),n("span",{staticClass:"line-number"},[t._v("37")]),n("br"),n("span",{staticClass:"line-number"},[t._v("38")]),n("br"),n("span",{staticClass:"line-number"},[t._v("39")]),n("br"),n("span",{staticClass:"line-number"},[t._v("40")]),n("br"),n("span",{staticClass:"line-number"},[t._v("41")]),n("br"),n("span",{staticClass:"line-number"},[t._v("42")]),n("br"),n("span",{staticClass:"line-number"},[t._v("43")]),n("br"),n("span",{staticClass:"line-number"},[t._v("44")]),n("br"),n("span",{staticClass:"line-number"},[t._v("45")]),n("br"),n("span",{staticClass:"line-number"},[t._v("46")]),n("br"),n("span",{staticClass:"line-number"},[t._v("47")]),n("br"),n("span",{staticClass:"line-number"},[t._v("48")]),n("br"),n("span",{staticClass:"line-number"},[t._v("49")]),n("br"),n("span",{staticClass:"line-number"},[t._v("50")]),n("br"),n("span",{staticClass:"line-number"},[t._v("51")]),n("br"),n("span",{staticClass:"line-number"},[t._v("52")]),n("br"),n("span",{staticClass:"line-number"},[t._v("53")]),n("br"),n("span",{staticClass:"line-number"},[t._v("54")]),n("br"),n("span",{staticClass:"line-number"},[t._v("55")]),n("br"),n("span",{staticClass:"line-number"},[t._v("56")]),n("br"),n("span",{staticClass:"line-number"},[t._v("57")]),n("br"),n("span",{staticClass:"line-number"},[t._v("58")]),n("br"),n("span",{staticClass:"line-number"},[t._v("59")]),n("br"),n("span",{staticClass:"line-number"},[t._v("60")]),n("br"),n("span",{staticClass:"line-number"},[t._v("61")]),n("br"),n("span",{staticClass:"line-number"},[t._v("62")]),n("br"),n("span",{staticClass:"line-number"},[t._v("63")]),n("br"),n("span",{staticClass:"line-number"},[t._v("64")]),n("br"),n("span",{staticClass:"line-number"},[t._v("65")]),n("br"),n("span",{staticClass:"line-number"},[t._v("66")]),n("br"),n("span",{staticClass:"line-number"},[t._v("67")]),n("br"),n("span",{staticClass:"line-number"},[t._v("68")]),n("br"),n("span",{staticClass:"line-number"},[t._v("69")]),n("br")])]),n("h2",{attrs:{id:"从正确定义智能指针开始"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#从正确定义智能指针开始"}},[t._v("#")]),t._v(" 从正确定义智能指针开始……")]),t._v(" "),n("p",[t._v("在项目中采用智能指针的初衷是为了实现多个对象之间共享数据，避免拷贝造成的开销。然而在使用的时候，我竟然连定义一个智能指针都能制造出五花八门的错误。。。下面分别整理了正确和错误的用法。")]),t._v(" "),n("h3",{attrs:{id:"_1-make-shared函数-最安全的分配和使用动态内存的方法"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-make-shared函数-最安全的分配和使用动态内存的方法"}},[t._v("#")]),t._v(" 1. "),n("code",[t._v("make_shared")]),t._v("函数：最安全的分配和使用动态内存的方法")]),t._v(" "),n("p",[t._v("类似顺序容器的"),n("code",[t._v("emplace")]),t._v("成员，"),n("code",[t._v("make_shared")]),t._v("用其参数来构造给定类型的对象。可以是一般的构造函数：")]),t._v(" "),n("div",{staticClass:"language-cpp line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-cpp"}},[n("code",[t._v("shared_ptr"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("Rect"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" p1 "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token generic-function"}},[n("span",{pre:!0,attrs:{class:"token function"}},[t._v("make_shared")]),n("span",{pre:!0,attrs:{class:"token generic class-name"}},[n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("Rect"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")])])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("r_points"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" r_width"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" r_height"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br")])]),n("p",[t._v("也可以是拷贝构造函数：")]),t._v(" "),n("div",{staticClass:"language-cpp line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-cpp"}},[n("code",[t._v("Rect "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("rect_2")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("r_points"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" r_width"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" r_height"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nshared_ptr"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("Rect"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" p2 "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token generic-function"}},[n("span",{pre:!0,attrs:{class:"token function"}},[t._v("make_shared")]),n("span",{pre:!0,attrs:{class:"token generic class-name"}},[n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("Rect"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")])])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("rect_2"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br")])]),n("div",{staticClass:"custom-block warning"},[n("p",{staticClass:"title"},[t._v("注意")]),n("p",[t._v("需要说明的一点是，由于"),n("code",[t._v("p2")]),t._v("指向的对象（即"),n("code",[t._v("*p2")]),t._v("）是"),n("code",[t._v("rect_2")]),t._v("的拷贝，所以它们的"),n("code",[t._v("_points")]),t._v("成员指向相同的内存，共享相同的"),n("code",[t._v("vector<Point>")]),t._v("。而这个"),n("code",[t._v("vector<Point>")]),t._v("是"),n("code",[t._v("r_points")]),t._v("的一份拷贝，保存在动态内存中。")])]),n("h3",{attrs:{id:"_2-shared-ptr和new结合使用"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-shared-ptr和new结合使用"}},[t._v("#")]),t._v(" 2. "),n("code",[t._v("shared_ptr")]),t._v("和"),n("code",[t._v("new")]),t._v("结合使用")]),t._v(" "),n("p",[t._v("可以用"),n("code",[t._v("new")]),t._v("返回的指针来初始化智能指针：")]),t._v(" "),n("div",{staticClass:"language-cpp line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-cpp"}},[n("code",[t._v("shared_ptr"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("Rect"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("p3")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("Rect")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("r_points"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" r_width"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" r_height"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br")])]),n("p",[t._v("或者将一个"),n("code",[t._v("shared_ptr")]),t._v("绑定到一个已经定义的普通指针：")]),t._v(" "),n("div",{staticClass:"language-cpp line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-cpp"}},[n("code",[t._v("Rect "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("x "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("Rect")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("r_points"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" r_width"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" r_height"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nshared_ptr"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("Rect"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("p4")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("x"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nx "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("nullptr")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br")])]),n("div",{staticClass:"custom-block warning"},[n("p",{staticClass:"title"},[t._v("这是一种不建议的写法")]),n("p",[t._v("原则上当"),n("code",[t._v("p4")]),t._v("绑定到"),n("code",[t._v("x")]),t._v("时，内存管理的责任就交给了"),n("code",[t._v("p4")]),t._v("，就不应该再使用"),n("code",[t._v("x")]),t._v("来访问"),n("code",[t._v("p4")]),t._v("指向的内存了。因此建议在完成绑定之后立刻将"),n("code",[t._v("x")]),t._v("置为空指针"),n("code",[t._v("nullptr")]),t._v("，避免在后续代码中使用"),n("code",[t._v("delete x")]),t._v("释放"),n("code",[t._v("p4")]),t._v("所指的内存，或者又将其他智能指针绑定到"),n("code",[t._v("x")]),t._v("上，这都会造成同一块内存多次释放的错误。")]),t._v(" "),n("p",[t._v("但这就出现一个尴尬的情况：程序员要时刻记得一个已经存在的变量不能使用，这要求实在是高了点。。。最理想的还是不要制造出"),n("code",[t._v("x")]),t._v("，或者说"),n("code",[t._v("x")]),t._v("的存在就没有意义。")])]),n("h3",{attrs:{id:"_3-【错误1】试图从raw指针隐式转换到智能指针"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-【错误1】试图从raw指针隐式转换到智能指针"}},[t._v("#")]),t._v(" 3. 【错误1】试图从raw指针隐式转换到智能指针")]),t._v(" "),n("div",{staticClass:"language-cpp line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-cpp"}},[n("code",[t._v("shared_ptr"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("Rect"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" p5 "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("Rect")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("r_points"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" r_width"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" r_height"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// !!!")]),t._v("\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br")])]),n("p",[t._v("【修改】接受指针参数的智能指针构造函数是"),n("code",[t._v("explicit")]),t._v("的，必须使用直接初始化形式：")]),t._v(" "),n("div",{staticClass:"language-cpp line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-cpp"}},[n("code",[t._v("shared_ptr"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("Rect"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("p5")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("Rect")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("r_points"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" r_width"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" r_height"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br")])]),n("h3",{attrs:{id:"_4-【错误2】将非动态分配的内存托管给智能指针"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_4-【错误2】将非动态分配的内存托管给智能指针"}},[t._v("#")]),t._v(" 4. 【错误2】将非动态分配的内存托管给智能指针")]),t._v(" "),n("div",{staticClass:"language-cpp line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-cpp"}},[n("code",[t._v("Rect "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("rect_6")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("r_points"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" r_width"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" r_height"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nshared_ptr"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("Rect"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("p6")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v("rect_6"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// !!!")]),t._v("\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br")])]),n("p",[t._v("这种写法将"),n("code",[t._v("p6")]),t._v("指向一块"),n("strong",[t._v("栈内存")]),t._v("，相当于局部变量"),n("code",[t._v("rect_6")]),t._v("和"),n("code",[t._v("p6")]),t._v("管理了同一内存空间，而栈内存中的对象是编译器负责创建和销毁的，而且不能析构一个指向非动态分配的内存的智能指针，因此是不合理的。")]),t._v(" "),n("p",[t._v("【修改】创建智能指针时"),n("strong",[t._v("传递一个空的删除器函数")]),t._v("或者"),n("strong",[t._v("直接使用raw指针")]),t._v("，详见"),n("a",{attrs:{href:"https://stackoverflow.com/questions/24049155/set-shared-ptr-to-point-existing-object",target:"_blank",rel:"noopener noreferrer"}},[t._v("stackoverflow"),n("OutboundLink")],1),t._v("。正如回答中说的："),n("em",[t._v("There is not much point in using a "),n("code",[t._v("shared_ptr")]),t._v(" for an automatically allocated object.")])]),t._v(" "),n("div",{staticClass:"language-cpp line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-cpp"}},[n("code",[t._v("Rect "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("rect_6")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("r_points"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" r_width"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" r_height"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nshared_ptr"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("Rect"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("p6")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v("rect_6"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Rect"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br")])]),n("h3",{attrs:{id:"_5-【错误3】将同一份动态内存托管给多个智能指针"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_5-【错误3】将同一份动态内存托管给多个智能指针"}},[t._v("#")]),t._v(" 5. 【错误3】将同一份动态内存托管给多个智能指针")]),t._v(" "),n("div",{staticClass:"language-cpp line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-cpp"}},[n("code",[t._v("Rect "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("xx "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("Rect")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("r_points"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" r_width"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" r_height"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nshared_ptr"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("Rect"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("p7")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("xx"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    shared_ptr"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("Rect"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("p8")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("xx"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// !!!")]),t._v("\n    shared_ptr"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("Rect"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("p9")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("p7"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("get")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// !!!")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\nxx "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("nullptr")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nRect rect_7 "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("p7"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br"),n("span",{staticClass:"line-number"},[t._v("4")]),n("br"),n("span",{staticClass:"line-number"},[t._v("5")]),n("br"),n("span",{staticClass:"line-number"},[t._v("6")]),n("br"),n("span",{staticClass:"line-number"},[t._v("7")]),n("br"),n("span",{staticClass:"line-number"},[t._v("8")]),n("br")])]),n("p",[n("code",[t._v("p7")]),t._v("、"),n("code",[t._v("p8")]),t._v("和"),n("code",[t._v("p9")]),t._v("指向了相同的动态内存，但由于它们是相互独立创建的，"),n("strong",[t._v("因此各自的引用计数都是1")]),t._v("，即相互不知道对方的存在，认为自己是这块内存的唯一管理者。当"),n("code",[t._v("p8")]),t._v("、"),n("code",[t._v("p9")]),t._v("所在程序块结束时，内存被释放，从而导致"),n("code",[t._v("p7")]),t._v("变为"),n("strong",[t._v("空悬指针")]),t._v("，意味着当试图使用"),n("code",[t._v("p7")]),t._v("时将发生未定义的行为；而且也存在同一内存多次释放的危险。")]),t._v(" "),n("p",[n("em",[t._v("Ps：在测试中还发现这种多个智能指针托管同一动态内存的情况与上文智能指针指向栈内存的情况，二者报错信息并不相同。")])]),t._v(" "),n("p",[t._v("【修改】与错误2类似，在创建智能指针时"),n("strong",[t._v("传递一个空的删除器函数")]),t._v("即可。")]),t._v(" "),n("div",{staticClass:"language-cpp line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-cpp"}},[n("code",[t._v("Rect "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("xx "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("Rect")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("r_points"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" r_width"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" r_height"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nshared_ptr"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("Rect"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("p7")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("xx"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    shared_ptr"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("Rect"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("p8")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("xx"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Rect"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    shared_ptr"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("Rect"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("p9")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("p7"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("get")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Rect"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\nxx "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("nullptr")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nRect rect_7 "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("p7"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br"),n("span",{staticClass:"line-number"},[t._v("4")]),n("br"),n("span",{staticClass:"line-number"},[t._v("5")]),n("br"),n("span",{staticClass:"line-number"},[t._v("6")]),n("br"),n("span",{staticClass:"line-number"},[t._v("7")]),n("br"),n("span",{staticClass:"line-number"},[t._v("8")]),n("br")])]),n("div",{staticClass:"custom-block warning"},[n("p",{staticClass:"title"},[t._v("小结")]),n("p",[t._v("本质上4和5属于同一类型的错误，即同一块内存由多个管理者托管，但它们彼此之间又不知道对方的存在，这样就导致在它们各自生命周期结束时都会释放这块内存的错误。个人认为，5的正确写法在某种程度上还是可以接受的，但4是一种完全不合理的智能指针使用方式，这种情况就应该直接使用raw指针，“只有将指向动态分配的对象的指针交给"),n("code",[t._v("shared_ptr")]),t._v("托管才是有意义的”。")]),t._v(" "),n("p",[t._v("往往这种错误在编译期间没有问题，但运行时会报错，因此不易排查。为了避免这种错误，应该养成良好的编程意识，《Cpp Primer》中提到几条基本规范，建议严格遵循：")]),t._v(" "),n("ul",[n("li",[t._v("不使用相同的raw指针初始化（或reset）多个智能指针。")]),t._v(" "),n("li",[t._v("不delete get()返回的指针。")]),t._v(" "),n("li",[t._v("不使用get()初始化或reset另一个智能指针。")]),t._v(" "),n("li",[t._v("如果你使用get()返回的指针，记住当最后一个对应的智能指针销毁后，你的指针就变为无效了。")]),t._v(" "),n("li",[t._v("如果你使用智能指针管理的资源不是new分配的内存，记住传递给它一个删除器。")])])]),n("h2",{attrs:{id:"智能指针的使用场景"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#智能指针的使用场景"}},[t._v("#")]),t._v(" 智能指针的使用场景")]),t._v(" "),n("p",[t._v("《Cpp Primer》中提到程序使用动态内存出于以下三种原因之一：")]),t._v(" "),n("blockquote",[n("ol",[n("li",[t._v("程序不知道自己需要使用多少对象")]),t._v(" "),n("li",[t._v("程序不知道所需对象的准确类型")]),t._v(" "),n("li",[t._v("程序需要在多个对象间共享数据")])])]),t._v(" "),n("p",[t._v("容器类是出于第一种原因而使用动态内存的典型例子，而2和3的需求可以使用（智能）指针很好地满足。")]),t._v(" "),n("h3",{attrs:{id:"智能指针成员"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#智能指针成员"}},[t._v("#")]),t._v(" 智能指针成员")]),t._v(" "),n("p",[t._v("基类"),n("code",[t._v("Polygon")]),t._v("中的"),n("code",[t._v("_points")]),t._v("成员是一个"),n("code",[t._v("shared_ptr")]),t._v("智能指针，依靠它实现了"),n("code",[t._v("Polygon")]),t._v("对象的不同拷贝之间共享相同的"),n("code",[t._v("vector<Point>")]),t._v("，并且此成员将记录有多少个对象共享了相同的"),n("code",[t._v("vector<Point>")]),t._v("，并且能在最后一个使用者被销毁时释放该内存。")]),t._v(" "),n("div",{staticClass:"language-cpp line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-cpp"}},[n("code",[t._v("Rect "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("rect_1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("r_points"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" r_width"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" r_height"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\ncout "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<<")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"rect_1 points成员地址: "')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<<")]),t._v(" rect_1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("_points"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("get")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<<")]),t._v(" endl"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\ncout "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<<")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"rect_1 points引用计数: "')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<<")]),t._v(" rect_1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("_points"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("use_count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<<")]),t._v(" endl"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\nRect rect_2 "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" rect_1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\ncout "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<<")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"rect_2 points成员地址: "')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<<")]),t._v(" rect_2"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("_points"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("get")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<<")]),t._v(" endl"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\ncout "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<<")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"rect_2 points引用计数: "')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<<")]),t._v(" rect_2"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("_points"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("use_count")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<<")]),t._v(" endl"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br"),n("span",{staticClass:"line-number"},[t._v("4")]),n("br"),n("span",{staticClass:"line-number"},[t._v("5")]),n("br"),n("span",{staticClass:"line-number"},[t._v("6")]),n("br"),n("span",{staticClass:"line-number"},[t._v("7")]),n("br")])]),n("p",[t._v("上述代码的运行结果：")]),t._v(" "),n("p",[n("img",{attrs:{src:a(593),alt:"smartptr_member"}})]),t._v(" "),n("h3",{attrs:{id:"容器与继承"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#容器与继承"}},[t._v("#")]),t._v(" 容器与继承")]),t._v(" "),n("p",[t._v("当我们使用容器存放继承体系中的对象时，因为不允许直接在容器中保存不同类型的元素，通常必须采取间接存储的方式，即我们实际上存放的是基类的（智能）指针，这些指针所指的对象可以是基类对象，也可以是派生类对象。当要使用具体的对象时，要利用多态性将基类指针下行转换为派生类指针。")]),t._v(" "),n("div",{staticClass:"language-cpp line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-cpp"}},[n("code",[t._v("vector"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("polygon_ptr"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" polygon_ptrs"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\npolygon_ptrs"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("push_back")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token generic-function"}},[n("span",{pre:!0,attrs:{class:"token function"}},[t._v("make_shared")]),n("span",{pre:!0,attrs:{class:"token generic class-name"}},[n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("Rect"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")])])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("r_points"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" r_width"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" r_height"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\npolygon_ptrs"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("push_back")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token generic-function"}},[n("span",{pre:!0,attrs:{class:"token function"}},[t._v("make_shared")]),n("span",{pre:!0,attrs:{class:"token generic class-name"}},[n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("Circle"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")])])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("c_points"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" c_radius"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//auto rect = dynamic_cast<Rect*>(polygon_ptrs.front()); // compile error")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//auto rect = dynamic_cast<rect_ptr>(polygon_ptrs.front()); // compile error")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("auto")]),t._v(" rect "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token generic-function"}},[n("span",{pre:!0,attrs:{class:"token function"}},[t._v("dynamic_pointer_cast")]),n("span",{pre:!0,attrs:{class:"token generic class-name"}},[n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("Rect"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")])])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("polygon_ptrs"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("front")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// compile success")]),t._v("\ncout "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<<")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"polygon_ptrs.front() shape: "')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<<")]),t._v(" rect"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("shape")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<<")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('" area: "')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<<")]),t._v(" rect"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("area")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<<")]),t._v(" endl"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("auto")]),t._v(" circle "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token generic-function"}},[n("span",{pre:!0,attrs:{class:"token function"}},[t._v("dynamic_pointer_cast")]),n("span",{pre:!0,attrs:{class:"token generic class-name"}},[n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("Circle"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")])])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("polygon_ptrs"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("back")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\ncout "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<<")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"polygon_ptrs.back() shape: "')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<<")]),t._v(" circle"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("shape")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<<")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('" area: "')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<<")]),t._v(" circle"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("area")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<<")]),t._v(" endl"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br"),n("span",{staticClass:"line-number"},[t._v("4")]),n("br"),n("span",{staticClass:"line-number"},[t._v("5")]),n("br"),n("span",{staticClass:"line-number"},[t._v("6")]),n("br"),n("span",{staticClass:"line-number"},[t._v("7")]),n("br"),n("span",{staticClass:"line-number"},[t._v("8")]),n("br"),n("span",{staticClass:"line-number"},[t._v("9")]),n("br"),n("span",{staticClass:"line-number"},[t._v("10")]),n("br")])]),n("p",[t._v("上述代码的运行结果：")]),t._v(" "),n("p",[n("img",{attrs:{src:a(594),alt:"smartptr_polymorphism"}})]),t._v(" "),n("div",{staticClass:"custom-block warning"},[n("p",{staticClass:"title"},[t._v("智能指针的下行转换")]),n("ol",[n("li",[t._v("必须使用"),n("code",[t._v("dynamic_pointer_cast")]),t._v("，而不是"),n("code",[t._v("dynamic_cast")]),t._v("。这是因为父子两种智能指针并非继承关系，而是完全不同的类型。")]),t._v(" "),n("li",[t._v("基类必须是多态类型（包含虚函数）。")])])]),n("h2",{attrs:{id:"github-代码"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#github-代码"}},[t._v("#")]),t._v(" [Github] 代码")]),t._v(" "),n("p",[t._v("项目实例均在vs2017上测试，并上传至"),n("a",{attrs:{href:"https://github.com/lyandut/MyCppPitfalls",target:"_blank",rel:"noopener noreferrer"}},[t._v("GitHub"),n("OutboundLink")],1),t._v("。")]),t._v(" "),n("h2",{attrs:{id:"reference-参考"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#reference-参考"}},[t._v("#")]),t._v(" [Reference] 参考")]),t._v(" "),n("p",[n("a",{attrs:{href:"https://stackoverflow.com/questions/24049155/set-shared-ptr-to-point-existing-object",target:"_blank",rel:"noopener noreferrer"}},[t._v("Stack Overflow: Set shared_ptr to point existing object"),n("OutboundLink")],1)]),t._v(" "),n("p",[n("a",{attrs:{href:"https://www.cnblogs.com/liushui-sky/p/13632028.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("C++11 shared_ptr（智能指针）详解"),n("OutboundLink")],1)])])}),[],!1,null,null,null);s.default=r.exports}}]);